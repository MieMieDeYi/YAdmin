(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b1f1727","chunk-4705f87d"],{4493:function(e,t,n){},8269:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",[n("el-form",{attrs:{inline:!0,model:e.searchFrom}},[n("el-row",{attrs:{type:"flex",justify:"start",gutter:0}},[n("el-form-item",{attrs:{label:"",size:"mini"}},[n("el-input",{attrs:{placeholder:"请输入菜单名称进行查询"},model:{value:e.searchFrom.name,callback:function(t){e.$set(e.searchFrom,"name",t)},expression:"searchFrom.name"}})],1),n("el-form-item",{attrs:{label:"",size:"mini"}},[n("div",{staticClass:"block"},[n("span",{staticClass:"demonstration"}),n("el-date-picker",{staticStyle:{width:"280px"},attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.searchFrom.dateScope,callback:function(t){e.$set(e.searchFrom,"dateScope",t)},expression:"searchFrom.dateScope"}})],1)]),n("el-form-item",{attrs:{size:"mini"}},[n("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"菜单状态状态"},model:{value:e.searchFrom.status,callback:function(t){e.$set(e.searchFrom,"status",t)},expression:"searchFrom.status"}},[n("el-option",{attrs:{label:"全部",value:0}}),e._l(e.statusOpt,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],2)],1),n("el-form-item",{attrs:{size:"mini"}},[n("el-button",{attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchHandler}},[e._v("搜索")])],1),n("el-form-item",{attrs:{size:"mini"}},[n("el-button",{attrs:{type:"warning",icon:"el-icon-refresh-left","native-type":"reset"}},[e._v("重置")])],1)],1)],1),n("el-row",[n("data-table",{attrs:{API:e.API}})],1)],1)],1)},a=[],r=n("b20d"),i={data:function(){return{searchFrom:{name:"",dateScope:null,status:null},API:this.$api.ROLE_API,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]},statusOpt:[{value:1,label:"启用"},{value:2,label:"禁用"}],table:{labels:[],props:{title:"角色列表",span:24,left:0,right:0}},pageData:{currentPage:2,totalCount:100,records:this.$store.state.menuModule.menu}}},methods:{searchHandler:function(){console.log(this.modelForm)},statusChange:function(e){var t=this;console.log(e.status),1!=e.status&&this.$confirm("检测到未保存的内容，是否在离开页面前保存修改？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"保存",cancelButtonText:"放弃修改"}).then((function(){t.$message({type:"info",message:"修改用户状态成功"})})).catch((function(t){e.status=1}))},selectionChange:function(e){e.length>0?this.isOperater=!1:this.isOperater=!0}},mounted:function(){},components:{DataTable:r["default"]}},l=i,s=n("9ca4"),c=Object(s["a"])(l,o,a,!1,null,null,null);t["default"]=c.exports},b20d:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{staticStyle:{position:"sticky"},attrs:{type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:12}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"small"},on:{click:e.addHandler}},[e._v("新增")]),n("el-button",{attrs:{type:"success",icon:"el-icon-edit",size:"small",disabled:1!=e.isOperater},on:{click:function(t){return e.modifyHandler(void 0)}}},[e._v("修改")]),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small",disabled:0==e.isOperater},on:{click:function(t){return e.removeHandler(void 0)}}},[e._v("删除")]),n("el-button",{attrs:{type:"warning",icon:"el-icon-document-add",size:"small",disabled:0==e.isOperater},on:{click:e.exportHandler}},[e._v("导出")])],1),n("el-col",{attrs:{span:3}},[n("el-button",{attrs:{type:"",plain:"",size:"mini",icon:"el-icon-refresh"},on:{click:function(t){return e.queryHandler(!0)}}}),n("el-button",{attrs:{type:"",plain:"",size:"mini",icon:"el-icon-full-screen"}})],1)],1),n("el-row",{attrs:{type:"flex",justify:"space-around",gutter:20}},[n("el-col",{attrs:{span:16}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header","body-style":"{margin:0}"},slot:"header"},[n("span",[n("b")])]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table.loading,expression:"table.loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.pageData.records,"highlight-current-row":"","row-key":"id"},on:{"selection-change":e.selectionChange,"row-click":e.rowlClick,select:e.rowSelect}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{label:"角色名称",prop:"nameZh",fixed:"left",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.nameZh))])]}}])}),n("el-table-column",{attrs:{label:"描述",prop:"desc",width:""}}),n("el-table-column",{attrs:{label:"角色名称(英文)",prop:"name",width:"150"}}),n("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{"active-value":1,"active-color":"#13ce66","inactive-value":0,"inactive-color":"#ff4949"},nativeOn:{click:function(n){return n.stopPropagation(),e.statusChange(t.row)}},model:{value:t.row.status,callback:function(n){e.$set(t.row,"status",n)},expression:"scope.row.status"}})]}}])}),n("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return n.stopPropagation(),e.modifyHandler(t.row)}}},[e._v("编辑")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return n.stopPropagation(),e.removeHandler(t.row)}}},[e._v("删除")])]}}])})],1),n("my-pagination",{attrs:{pageData:e.pageData,pageInfo:e.pageInfo},on:{queryHandler:e.queryHandler}})],1)],1),n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[n("b",[e._v("权限分配")]),n("span",{staticStyle:{"font-size":"14px","margin-left":"10px"}},[e._v("\n                "+e._s(e.authority.role.nameZh)+"\n              ")])]),n("el-button",{staticStyle:{float:"right",padding:"3px 5px"},attrs:{size:"mini",type:"primary"},on:{click:e.addRoleMenus}},[e._v("保存")])],1),n("el-tree",{ref:"authorityTree",attrs:{data:e.authority.tree,"show-checkbox":!0,"node-key":"id","check-strictly":!0,"default-expanded-keys":[1],props:e.authority.defaultProps},on:{check:e.nodeCheck}}),n("el-checkbox",{attrs:{indeterminate:e.authority.isIndeterminate},on:{change:function(t){e.authorityHandler().handleCheckAllChange()}},model:{value:e.authority.checkAll,callback:function(t){e.$set(e.authority,"checkAll",t)},expression:"authority.checkAll"}},[e._v("\n\t\t\t\t\t\t全选\n          ")])],1)],1)],1),n("el-dialog",{attrs:{title:e.dialog.title+"角色",visible:e.dialog.visible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)},open:e.queryRoles,close:e.dialogClose}},[n("el-form",{ref:"modelForm",attrs:{model:e.modelForm,rules:e.form.formRules,"status-icon":"","label-position":"right",size:"small","label-width":"80px"}},[n("el-row",{attrs:{type:"flex",justify:"space-between"}},[n("el-col",{staticStyle:{display:"none"},attrs:{span:24}},[n("el-form-item",{attrs:{label:"id"}},[n("el-input",{model:{value:e.modelForm.id,callback:function(t){e.$set(e.modelForm,"id",t)},expression:"modelForm.id"}})],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"角色名称",prop:"nameZh"}},[n("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.modelForm.nameZh,callback:function(t){e.$set(e.modelForm,"nameZh",t)},expression:"modelForm.nameZh"}})],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"英文名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"'请输入角色英文名称"},model:{value:e.modelForm.name,callback:function(t){e.$set(e.modelForm,"name",t)},expression:"modelForm.name"}},[n("template",{slot:"prepend"},[e._v("ROLE_")])],2)],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"状态",prop:"status"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"默认状态为启用"},model:{value:e.modelForm.status,callback:function(t){e.$set(e.modelForm,"status",t)},expression:"modelForm.status"}},[n("el-option",{attrs:{label:"启用",value:1}}),n("el-option",{attrs:{label:"禁用",value:0}})],1)],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"描述",prop:"desc"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入角色描述信息"},model:{value:e.modelForm.desc,callback:function(t){e.$set(e.modelForm,"desc",t)},expression:"modelForm.desc"}})],1)],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialog.visible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.resetForm()}}},[e._v("重 置")]),n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitHandler(0)}}},[e._v(e._s(e.dialog.submitText))])],1)],1)],1)},a=[],r=(n("309f"),n("0b53"),n("06a2"),n("ec25"),n("cc57"),n("2b45"),n("6d57"),n("b449"),n("6648"));function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function l(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var c={name:"RoleTable",data:function(){return{checkedKeys:[],isOperater:0,table:{loading:!0,rows:[]},authority:{role:{},tree:[],selected:[],defaultProps:{children:"children",label:"name"},checkAll:!1,isIndeterminate:!1},dialog:{visible:!1,title:"",submitText:"提交"},pageInfo:{current:1,size:10,total:0,parentMenu:0},modelForm:{id:null,name:null,nameZh:null,desc:null,status:1},form:{roles:[],originalModel:{},formRules:{username:[{required:!0,message:"用户名不可以为空",trigger:"blur"},{min:5,max:20,message:"长度在5-20个字符之间",trigger:"blur"}],nickname:[{max:10,message:"昵称最长为10个字符",trigger:"blur"}],email:[{required:!0,type:"email",message:"长度在2-20个字符之间",trigger:"blur"},{min:6,max:30,message:"长度在6-30个字符之间"}]}},pageData:{current:1,total:0,records:[]},method:this.$axios.get}},methods:{onSelect:function(e,t){console.log(e)},statusChange:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.method=this.$axios.post,1==t.status){e.next=8;break}return e.next=4,this.$alert("是否将当前【"+t.nameZh+"】设置为禁用状态","禁用角色",{distinguishCancelAndClose:!0,confirmButtonText:"禁用",cancelButtonText:"取消"}).then((function(){t.status=0})).catch((function(e){t.status=1}));case 4:if(1!=t.status){e.next=6;break}return e.abrupt("return");case 6:e.next=9;break;case 8:t.status=1;case 9:this.baseRequest({id:t.id,status:t.status},!1).then((function(e){200==e.code&&n.$notify({title:"修改角色“"+t.nameZh+"”状态成功",type:"success"})})).catch((function(e){t.status=0==t.status?1:0,n.$notify({title:"修改出现错误",type:"error"})}));case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),selectionChange:function(e){this.isOperater=e.length,this.table.rows=e},rowSelect:function(e,t){console.log(e,t)},rowlClick:function(e){console.log(e),this.getRoleMenu(e)},authorityHandler:function(){var e=this;return{handleCheckAllChange:function(){var t=e.authority.checkAll?e.authority.tree.map((function(e){return e.id})):[];console.log(e.authority.tree),e.$refs.authorityTree.setCheckedKeys(t)},nodeClick:function(t,n){console.log(t,n),console.log(e.$refs.authorityTree.getCheckedKeys())}}},nodeCheck:function(e,t){var n,o=this,a=function e(t,n){null!=t.children&&0!=t.children.length&&t.children.forEach((function(t){return o.$refs.authorityTree.setChecked(t.id,n),e(t,n)}))},r=!1,l=i(t.checkedKeys);try{for(l.s();!(n=l.n()).done;){var s=n.value;if(s==e.id){r=!0;break}}}catch(err){l.e(err)}finally{l.f()}a(e,r)},getRoleMenu:function(e){var t=this;this.authority.role=e,this.$axios.get(this.$api.ROLE_MENU_API,{roleId:e.id},!1).then((function(e){t.$refs.authorityTree.setCheckedKeys(e.data),t.authority.selected=e.data}))},addRoleMenus:function(){this.method=this.$axios.post;this.$refs.authorityTree.getCheckedNodes(!1,!0).map((function(e){return e.id}));this.baseRequest({id:this.authority.role.id,menuIds:this.$refs.authorityTree.getCheckedKeys()})},baseRequest:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=!(o.length>1&&void 0!==o[1])||o[1],console.log(this.API),e.next=4,this.method(this.API,t,n).then((function(e){return console.log(e),e.code,e})).catch((function(e){Promise.reject(e)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),queryHandler:function(e){var t=this;e&&(this.authority.role={},this.authority.tree=this.$store.state.menuModule.menu),this.table.loading=!0,this.$axios.get(this.API,this.pageInfo).then((function(e){t.pageData=e.data?e.data:{current:1,total:0,records:[]},t.table.loading=!1})).catch((function(e){t.table.loading=!1}))},addHandler:function(){this.dialog.title="新增",this.dialog.submitText="新增",this.dialog.visible=!0,this.method=this.$axios.put},modifyHandler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.table.rows.slice(-1)[0];this.modelForm=e,this.form.originalModel=JSON.parse(JSON.stringify(e)),this.dialog.title="修改",this.dialog.submitText="更新",this.dialog.visible=!0,this.method=this.$axios.post},removeHandler:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.table.rows;this.$alert("本次操作一经确认将无法撤回，是否继续","角色删除",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then((function(){e.method=e.$axios.delete,Array.isArray(t)?e.baseRequest(t.map((function(e){return e.id}))).then((function(t){return e.queryHandler()})).catch(err>={}):e.baseRequest([t.id]).then((function(t){return e.queryHandler()})).catch(err>={})})).catch((function(e){}))},exportHandler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.table.rows;console.log(e),console.log(e)},submitHandler:function(e){var t=this;console.log(this.modelForm),this.$refs["modelForm"].validate((function(e){if(!e)return!1;t.method(t.API,t.modelForm).then((function(e){200==e.code&&(t.form.originalModel=null,t.dialog.visible=!1)}))}))},resetForm:function(){this.modelForm={}},typeChange:function(e){console.log(e)},queryRoles:function(){var e=this;0==this.form.roles.length&&this.$axios.get(this.$api.ROLE_API,{size:20},!1).then((function(t){e.form.roles=t.data.records}))},dialogClose:function(){console.log(this.form.originalModel),null!=this.form.originalModel&&this.$tools.copyObj(this.modelForm,this.form.originalModel,this),this.modelForm={}}},computed:{},mounted:function(){this.queryHandler(!0),this.authority.tree=this.$store.state.menuModule.menu,console.log(this.authority)},watch:{pageInfo:function(){console.log("我变了")}},props:{API:String}},u=c,d=(n("f41e"),n("9ca4")),h=Object(d["a"])(u,o,a,!1,null,null,null);t["default"]=h.exports},f41e:function(e,t,n){"use strict";var o=n("4493"),a=n.n(o);a.a}}]);